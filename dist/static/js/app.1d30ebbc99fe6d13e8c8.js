webpackJsonp([1],{"1CsI":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"craft-box"},[t.notEdit?t._e():s("div",{staticClass:"flex-box flex-center"},[s("el-button",{staticClass:"flex-box",attrs:{type:"warning",plain:""},on:{click:function(e){t.adds(t.items[0])}}},[t._v("添加主流程"),s("i",{staticClass:"el-icon--right el-icon-circle-plus-outline"})]),t._v(" "),s("el-button",{staticClass:"flex-box",attrs:{type:"success",plain:""},on:{click:function(e){t.adds(t.items[1])}}},[t._v("添加半成品"),s("i",{staticClass:"el-icon--right el-icon-circle-plus-outline"})]),t._v(" "),s("el-button",{staticClass:"flex-box",attrs:{type:"primary",plain:""},on:{click:function(e){t.adds(t.items[2])}}},[t._v("添加工序"),s("i",{staticClass:"el-icon--right el-icon-circle-plus-outline"})])],1),t._v(" "),s("div",{staticClass:"flex-box flex-center"},[s("ul",{staticClass:"craft-info flex-box",on:{dragover:function(e){return e.stopPropagation(),t.handleDragOver(e)},drop:function(e){return e.stopPropagation(),t.handleDrag(e)}}},t._l(t.craftLineCopy,function(e,a){return s("items",{key:a,attrs:{model:e,"item-height":t.itemHeight}})}))])])},i=[],r={render:a,staticRenderFns:i};e.a=r},"2+ao":function(t,e,s){"use strict";s("Qgp7"),s("Zsfk");e.a={}},"2mXc":function(t,e,s){"use strict";e.a={}},D6Am:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("li",{staticClass:"item"},["process"===t.model.procedureType?s("div",{staticClass:"item-info",class:[t.model.procedureType,{border:t.$store.state.selectHash==t.model.hash},t.$store.state.activeHash==t.model.hash?t.$store.state.activeDirection:"",{disabled:t.$store.state.startHash==t.model.hash},{fixed:t.model.fixed}],style:{height:t.itemHeight+"px"},attrs:{draggable:!t.model.fixed,"data-hash":t.model.hash},on:{dragstart:function(e){return e.stopPropagation(),t.changeDragStart(e)},dragend:function(e){return e.stopPropagation(),t.changeDragEnd(e)},click:function(e){e.stopPropagation(),e.preventDefault(),t.select(t.model)}}},[t.model.fixed?t._e():s("div",{staticClass:"j-delete"},[s("i",{staticClass:"el-icon-remove-outline",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.del(t.model.hash)}}})]),t._v(" "),s("div",{staticClass:"info"},[t._v("\n      "+t._s(t.model.procedureName)+"\n    ")])]):"semi"===t.model.procedureType?s("div",{staticClass:"item-info",class:[t.model.procedureType,{border:t.$store.state.selectHash==t.model.hash},t.$store.state.activeHash==t.model.hash?t.$store.state.activeDirection:"",{disabled:t.$store.state.startHash==t.model.hash}],attrs:{draggable:"true","data-hash":t.model.hash},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.select(t.model)},dragstart:function(e){return e.stopPropagation(),t.changeDragStart(e)},dragend:function(e){return e.stopPropagation(),t.changeDragEnd(e)}}},[s("div",{staticClass:"info"},[t._v("\n      "+t._s(t.model.procedureName)),t.model.procedureQuantity&&t.model.procedureQuantity>1?s("span",[t._v("*"+t._s(t.model.procedureQuantity))]):t._e(),t._v(" "),t.totalNum>0?s("div",{on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.isShow=!t.isShow}}},[s("i",{class:t.isShow?"el-icon-caret-bottom":"el-icon-caret-top"}),t._v(t._s(t.totalNum)+"道工序\n      ")]):t._e(),t._v(" "),s("div",{staticClass:"j-delete"},[s("i",{staticClass:"el-icon-remove-outline",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.del(t.model.hash)}}})])])]):s("div",{staticClass:"item-info",class:[t.model.procedureType,{border:t.$store.state.selectHash==t.model.hash},t.$store.state.activeHash==t.model.hash?t.$store.state.activeDirection:"",{disabled:t.$store.state.startHash==t.model.hash},{fixed:t.model.fixed}],attrs:{draggable:!t.model.fixed,"data-hash":t.model.hash},on:{dragstart:function(e){return e.stopPropagation(),t.changeDragStart(e)},dragend:function(e){return e.stopPropagation(),t.changeDragEnd(e)},click:function(e){e.stopPropagation(),e.preventDefault(),t.select(t.model)}}},[s("div",{staticClass:"info"},[t._v("\n      "+t._s(t.model.procedureName)+"\n      "),t.totalNum>0?s("div",[t._v(t._s(t.totalNum)+"道工序")]):t._e(),t._v(" "),t.model.fixed?t._e():s("div",{staticClass:"j-delete"},[s("i",{staticClass:"el-icon-remove-outline",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.del(t.model.hash)}}})])])]),t._v(" "),t.model.children&&t.model.children.length>0?s("ul",{class:{isShow:!t.isShow}},t._l(t.model.children,function(e,a){return s("items",{key:a,attrs:{model:e,"item-height":t.itemHeight}})})):t._e()])},i=[],r={render:a,staticRenderFns:i};e.a=r},GMIA:function(t,e,s){"use strict";var a,i=s("bOdI"),r=s.n(i),o=s("Qgp7");e.a=(a={},r()(a,o.b,function(t,e){t.orderFlowInfo=e}),r()(a,o.a,function(t,e){t.orderFlowInfoActive=e}),r()(a,o.c,function(t,e){t.houseDialog=!t.houseDialog,e&&(t.finalState=e.colorType,t.houseResId=e.houseResId)}),a)},IEfW:function(t,e,s){"use strict";function a(t){s("eCin")}var i=s("oDO2"),r=s("KGta"),o=s("VU/8"),n=a,c=o(i.a,r.a,!1,n,null,null);e.a=c.exports},KGta:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"warp-box flex-direction-box"},[s("div",[s("el-button",{attrs:{type:"primary"},on:{click:t.add}},[t._v("外部添加自带工序")])],1),t._v(" "),s("craft",{ref:"craft",attrs:{"craft-line":t.craftLine,"add-before":t.addBefore},on:{"get-list":t.getList}})],1)},i=[],r={render:a,staticRenderFns:i};e.a=r},M93x:function(t,e,s){"use strict";function a(t){s("QMUp")}var i=s("xJD8"),r=s("UhAd"),o=s("VU/8"),n=a,c=o(i.a,r.a,!1,n,null,null);e.a=c.exports},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("fZjL"),i=s.n(a),r=s("7+uW"),o=s("M93x"),n=s("YaEn"),c=s("Zsfk"),l=s("zL8q"),u=s.n(l),h=s("bGai");r.default.use(u.a),i()(h.a).forEach(function(t){var e=t.replace(/(\w)/,function(t){return t.toUpperCase()});r.default.component("v"+e,h.a[t])}),n.a.beforeEach(function(t,e,s){s()}),new r.default({el:"#app",store:c.a,router:n.a,render:function(t){return t(o.a)},template:"<App/>",components:{App:o.a}})},NWCo:function(t,e,s){"use strict";function a(t){s("p810")}var i=s("irzW"),r=s("D6Am"),o=s("VU/8"),n=a,c=o(i.a,r.a,!1,n,null,null);e.a=c.exports},QMUp:function(t,e){},Qgp7:function(t,e,s){"use strict";s.d(e,"b",function(){return a}),s.d(e,"a",function(){return i}),s.d(e,"c",function(){return r});var a="SAVE_ORDERFLOWADD",i="SAVE_ORDERFLOWACTIVE",r="SHOW_HOUSE_INFO"},UhAd:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},i=[],r={render:a,staticRenderFns:i};e.a=r},YaEn:function(t,e,s){"use strict";var a=s("7+uW"),i=s("/ocq"),r=s("IEfW");a.default.use(i.a),e.a=new i.a({routes:[{path:"",redirect:"/login"},{path:"/craftLine",component:r.a,name:"工艺路线"}]})},Zsfk:function(t,e,s){"use strict";var a=s("//Fk"),i=s.n(a),r=s("7+uW"),o=s("NYxO"),n=s("GMIA"),c=s("2+ao"),l=s("2mXc");r.default.use(o.a),window.Promise=i.a;var u={history:[],startHash:-1,moveItem:{},selectHash:-1,deleteHash:-1,activeHash:-1,activeDirection:"top"};e.a=new o.a.Store({state:u,getters:l.a,actions:c.a,mutations:n.a})},ZxKi:function(t,e){},bGai:function(t,e,s){"use strict";e.a={}},eCin:function(t,e){},irzW:function(t,e,s){"use strict";e.a={name:"items",props:["model","itemHeight","edit"],data:function(){return{totalNum:0,isShow:!0}},mounted:function(){this.total(this.model)},computed:{},methods:{total:function(t){var e=this;t.children&&t.children.length>0?t.children.forEach(function(t){e.total(t)}):"process"===t.procedureType&&this.totalNum++},changeDragStart:function(t){this.$store.state.startHash=t.target.getAttribute("data-hash")},changeDragEnd:function(t){this.$store.state.startHash=-1,this.$store.state.activeHash=-1},select:function(t){this.$store.state.selectHash=t.hash},del:function(t){this.$store.state.deleteHash=t}},components:{},filters:{},watch:{model:{handler:function(t,e){this.totalNum=0,this.total(this.model)},deep:!0}}}},oDO2:function(t,e,s){"use strict";var a=s("mvHQ"),i=s.n(a),r=s("tH33");e.a={data:function(){return{craftLine:[{procedureType:"flow",procedureName:"主流程",hash:1539651058192,fixed:!0,children:[{procedureType:"semi",procedureName:"半成品",hash:1539651058193,fixed:!0,children:[{procedureType:"process",procedureName:"自带工序",hash:1539651058194,fixed:!0},{procedureType:"process",procedureName:"自带工序2",hash:1539651058195,fixed:!0}]}]}],halfList:[]}},computed:{},mounted:function(){},components:{craft:r.a},methods:{addBefore:function(t,e){e(t)},add:function(){this.$refs.craft.addresult({procedureType:"process",procedureName:"自带工序",hash:1539651058195})},getList:function(t){var e=this;this.halfList=[];var s=JSON.parse(i()(t));s.reverse();for(var a=null,r=s.length,o=[],n=0;n<s.length;n++)if(s[n].hash==this.$store.state.selectHash)a=n,console.log(a);else if("process"==s[n].procedureType&&null!=a){r=n,console.log(r);break}r-a>1&&(o=s.slice(a+1,r),o.forEach(function(t){"semi"==t.procedureType?e.halfList.push(t):e.getHalf(t.children)})),console.log(this.halfList)},getHalf:function(t){var e=this;t.forEach(function(t){"semi"==t.procedureType?e.halfList.push(t):t.children&&t.children.length>0&&e.getHalf(t.children)})}},watch:{}}},p810:function(t,e){},tH33:function(t,e,s){"use strict";function a(t){s("ZxKi")}var i=s("uGBY"),r=s("1CsI"),o=s("VU/8"),n=a,c=o(i.a,r.a,!1,n,null,null);e.a=c.exports},uGBY:function(t,e,s){"use strict";var a=s("mvHQ"),i=s.n(a),r=s("woOf"),o=s.n(r),n=(s("yclV"),s("NWCo"));e.a={data:function(){return{items:[{procedureType:"flow",procedureName:"主流程",children:[]},{procedureType:"semi",procedureName:"边方块",children:[{procedureType:"process",procedureName:"工序",children:[]}]},{procedureType:"process",procedureName:"工序",children:[],checkState:!1}],itemHeight:54,hasSelect:!1,craftLineCopy:[]}},props:{craftLine:{type:Array},addBefore:{type:Function},notEdit:{type:Boolean}},computed:{},created:function(){},mounted:function(){this.craftLineCopy=this.craftLine,this.$store.state.selectHash=this.craftLineCopy[0].hash},components:{items:n.a},methods:{adds:function(t){this.addBefore(t,this.addresult)},addresult:function(t){var e=this;this.recursion(this.craftLineCopy,this.$store.state.selectHash,function(s,a){if("flow"==s[a].procedureType){var r=o()({},{hash:Date.now(),children:[]},t);s[a].children.push(r)}e.craftLineCopy=JSON.parse(i()(e.craftLineCopy))})},handleDragOver:function(t){if(t.preventDefault(),t.dataTransfer.dropEffect="move",!(t.target.className.indexOf("fixed")>-1)){var e=t.target.getAttribute("data-hash");if(null!=e){this.$store.state.activeHash=e;var s=t.target.getBoundingClientRect().y+t.target.getBoundingClientRect().height/2;t.pageY>s?this.$store.state.activeDirection="bottom":this.$store.state.activeDirection="top"}}},handleDrag:function(){var t=this;-1!=this.$store.state.activeHash&&-1!=this.$store.state.startHash&&this.$store.state.startHash!=this.$store.state.activeHash&&(this.remove(this.craftLineCopy,this.$store.state.startHash),this.add(this.craftLineCopy,this.$store.state.activeHash),this.recursion(this.craftLineCopy,this.$store.state.selectHash,function(e,s){"process"==e[s].procedureType&&t.$emit("get-list",e)}))},remove:function(t,e){var s=this;this.recursion(t,e,function(t,e){s.$store.state.moveItem=t[e],t.splice(e,1)})},add:function(t,e){var s=this;this.recursion(t,e,function(t,e){"top"===s.$store.state.activeDirection?t.splice(e,0,s.$store.state.moveItem):t.splice(e+1,0,s.$store.state.moveItem)})},recursion:function(t,e,s){for(var a=0;a<t.length;a++){if(Number(t[a].hash)===Number(e))return s(t,a),!1;t[a].children&&t[a].children.length>0&&this.recursion(t[a].children,e,s)}}},watch:{"$store.state.deleteHash":{handler:function(t){var e=this;this.hasSelect=!1,this.recursion(this.craftLineCopy,t,function(t,e){t.splice(e,1)}),this.recursion(this.craftLineCopy,this.$store.state.selectHash,function(t,s){e.hasSelect=!0}),this.hasSelect||(this.$store.state.selectHash=this.craftLineCopy[0].hash)}},"$store.state.selectHash":function(t){var e=this;this.recursion(this.craftLineCopy,t,function(t,s){"process"==t[s].procedureType&&e.$emit("get-list",t)})},craftLineCopy:function(t){this.$emit("line",t)}}}},xJD8:function(t,e,s){"use strict";e.a={name:"app"}},yclV:function(t,e,s){"use strict";var a=s("BO1k"),i=(s.n(a),s("//Fk")),r=(s.n(i),s("mvHQ"));s.n(r),s("Zsfk");document.body.addEventListener("touchmove",function(t){t._isScroller||t.preventDefault()}),Array.prototype.remove=function(t){var e=this.indexOf(t);e>-1&&this.splice(e,1)};Date.prototype.format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()},s=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"];/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),/(w+)/.test(t)&&(t=t.replace(RegExp.$1,s[this.getDay()]));for(var a in e)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[a]:("00"+e[a]).substr((""+e[a]).length)));return t},Date.prototype.add=function(t,e){switch(e*=1,isNaN(e)&&(e=0),t){case"y":this.setFullYear(this.getFullYear()+e);break;case"m":this.setMonth(this.getMonth()+e);break;case"d":this.setDate(this.getDate()+e);break;case"h":this.setHours(this.getHours()+e);break;case"n":this.setMinutes(this.getMinutes()+e);break;case"s":this.setSeconds(this.getSeconds()+e)}return this}}},["NHnr"]);
//# sourceMappingURL=app.1d30ebbc99fe6d13e8c8.js.map